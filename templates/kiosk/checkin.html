<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Welcome System Check-In</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  {% for font_href in google_font_hrefs %}
    <link rel="stylesheet" href="{{ font_href }}" />
  {% endfor %}
  <link rel="stylesheet" href="/static/css/theme.css" />
  <link rel="stylesheet" href="/static/css/kiosk.css?v=13" />
</head>
<body
  class="kiosk-body"
  style="--kiosk-bg-light: {{ kiosk_background_color }}; --kiosk-bg-dark: {{ kiosk_background_color_darkmode }};"
>
  <main class="container py-3">
    {% if kiosk_mode %}
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="d-flex align-items-center gap-2">
          <button id="font-toggle" class="btn btn-outline-secondary btn-sm" type="button" aria-label="Increase font size">
            A+
          </button>
          <button id="theme-toggle" class="btn btn-outline-secondary btn-sm" type="button" aria-label="Toggle dark mode">
            ðŸŒ™
          </button>
        </div>
        <div class="dropdown">
          <button
            class="btn btn-outline-secondary btn-sm info-menu-toggle"
            type="button"
            id="kiosk-info-menu-btn"
            data-bs-toggle="dropdown"
            aria-expanded="false"
            aria-label="Open kiosk info menu"
          >
            i
          </button>
          <div class="dropdown-menu p-3 kiosk-info-menu" aria-labelledby="kiosk-info-menu-btn" id="connection-status">
            <div class="d-flex align-items-center gap-2 mb-2">
              <span class="status-dot" id="status-dot-menu"></span>
              <span class="status-text" id="status-text-menu">Server online</span>
            </div>
            <div class="text-muted mb-3" id="version-line-menu" style="font-size: 0.72rem;">v{{ app_version }}</div>
            <div class="text-muted mb-3" id="service-line-menu" style="font-size: 0.72rem;">
              {% if service_open %}
                Service: {{ service_label }}
              {% else %}
                No service open
              {% endif %}
            </div>
            <a class="btn btn-outline-danger btn-sm w-100" href="/kiosk/logout/" style="font-size: 0.8rem; padding: 0.3rem 0.5rem;">Log out</a>
          </div>
        </div>
      </div>
    {% endif %}
    <div class="text-center mb-3">
      <img
        class="kiosk-logo mb-3"
        src="{{ kiosk_logo_path }}"
        alt="Church logo"
        style="width: {{ kiosk_logo_width_px }}px; {% if kiosk_logo_height_px %}height: {{ kiosk_logo_height_px }}px;{% else %}height: auto;{% endif %}"
      />
      <h1 class="display-4 fw-bold" id="kiosk-title" style="font-family: {{ welcome_heading_font_family }};">{{ welcome_heading }}</h1>
      <p class="lead"></p>
    </div>

    <form class="mb-4" method="get" id="search-form">
      <div class="input-group input-group-lg">
        <input
          class="form-control"
          type="text"
          name="q"
          id="search-input"
          value="{{ query }}"
          placeholder="Enter last name or last 4 phone digits..."
          autofocus
        />
        <button class="btn btn-primary" type="submit">Search</button>
      </div>
    </form>
    <div class="kiosk-keyboard mb-4" id="kiosk-keyboard" aria-label="On-screen keyboard">
      <div class="kb-row">
        <button class="kb-key" type="button" data-key="1">1</button>
        <button class="kb-key" type="button" data-key="2">2</button>
        <button class="kb-key" type="button" data-key="3">3</button>
        <button class="kb-key" type="button" data-key="4">4</button>
        <button class="kb-key" type="button" data-key="5">5</button>
        <button class="kb-key" type="button" data-key="6">6</button>
        <button class="kb-key" type="button" data-key="7">7</button>
        <button class="kb-key" type="button" data-key="8">8</button>
        <button class="kb-key" type="button" data-key="9">9</button>
        <button class="kb-key" type="button" data-key="0">0</button>
      </div>
      <div class="kb-row">
        <button class="kb-key" type="button" data-key="Q">Q</button>
        <button class="kb-key" type="button" data-key="W">W</button>
        <button class="kb-key" type="button" data-key="E">E</button>
        <button class="kb-key" type="button" data-key="R">R</button>
        <button class="kb-key" type="button" data-key="T">T</button>
        <button class="kb-key" type="button" data-key="Y">Y</button>
        <button class="kb-key" type="button" data-key="U">U</button>
        <button class="kb-key" type="button" data-key="I">I</button>
        <button class="kb-key" type="button" data-key="O">O</button>
        <button class="kb-key" type="button" data-key="P">P</button>
      </div>
      <div class="kb-row">
        <button class="kb-key" type="button" data-key="A">A</button>
        <button class="kb-key" type="button" data-key="S">S</button>
        <button class="kb-key" type="button" data-key="D">D</button>
        <button class="kb-key" type="button" data-key="F">F</button>
        <button class="kb-key" type="button" data-key="G">G</button>
        <button class="kb-key" type="button" data-key="H">H</button>
        <button class="kb-key" type="button" data-key="J">J</button>
        <button class="kb-key" type="button" data-key="K">K</button>
        <button class="kb-key" type="button" data-key="L">L</button>
      </div>
      <div class="kb-row">
        <button class="kb-key" type="button" data-key="Z">Z</button>
        <button class="kb-key" type="button" data-key="X">X</button>
        <button class="kb-key" type="button" data-key="C">C</button>
        <button class="kb-key" type="button" data-key="V">V</button>
        <button class="kb-key" type="button" data-key="B">B</button>
        <button class="kb-key" type="button" data-key="N">N</button>
        <button class="kb-key" type="button" data-key="M">M</button>
        <button class="kb-key kb-backspace" type="button" data-action="backspace">Backspace</button>
      </div>
      <div class="kb-row">
        <button class="kb-key kb-space" type="button" data-key=" ">Space</button>
        <button class="kb-key kb-clear" type="button" data-action="clear">Clear</button>
      </div>
    </div>

    <div class="mb-3 text-center">
      <button id="visitor-toggle" class="btn btn-outline-secondary btn-lg" type="button">
        I'm new here ðŸ™‚
      </button>
    </div>
    <div class="modal fade" id="visitor-modal" tabindex="-1" aria-labelledby="visitor-modal-title" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="modal-title h4 mb-0" id="visitor-modal-title">New Visitor</h2>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form method="post" class="row g-3" id="visitor-form">
              {% csrf_token %}
              <div class="col-md-6">
                <label class="form-label">First name</label>
                <input class="form-control form-control-lg" name="first_name" required />
              </div>
              <div class="col-md-6">
                <label class="form-label">Last name</label>
                <input class="form-control form-control-lg" name="last_name" required />
              </div>
              <div class="col-md-6">
                <label class="form-label">Phone (optional)</label>
                <input class="form-control form-control-lg" name="phone" />
              </div>
              <div class="col-md-6">
                <label class="form-label">Email (optional)</label>
                <input class="form-control form-control-lg" name="email" />
              </div>
              <div class="col-12">
                <div class="d-flex gap-2 flex-wrap">
                  <button class="btn btn-primary btn-lg" type="submit" name="action" value="print_single">Print Name Tag</button>
                  <button class="btn btn-outline-primary btn-lg" type="submit" name="action" value="check_in_only">Check in only</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="search-results-modal" tabindex="-1" aria-labelledby="search-results-title" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="modal-title h4 mb-0" id="search-results-title">Matches</h2>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="search-results-list" class="d-flex flex-column gap-3"></div>
            <p id="search-results-empty" class="text-muted mb-0 d-none">No matches found. Add as a new visitor below.</p>
          </div>
        </div>
      </div>
    </div>
    <div class="print-modal" id="print-modal" aria-hidden="true">
      <div class="print-modal-content">
        <div class="print-modal-header">
          <h2 class="h4 mb-0">Printing nametags</h2>
          <button class="btn btn-outline-secondary" type="button" id="print-modal-close">Cancel</button>
        </div>
        <iframe title="Nametag print preview" id="print-frame"></iframe>
        <p class="text-muted mb-0">After printing, you will return to check-in.</p>
        <div class="print-modal-actions">
          <button class="btn btn-primary" type="button" id="print-modal-print">Print now</button>
        </div>
      </div>
    </div>
  </main>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    (function () {
      const kioskMode = {{ kiosk_mode|yesno:"true,false" }};
      const iframePrintEnabled = {{ iframe_print|yesno:"true,false" }};
      const form = document.getElementById("search-form");
      const input = document.getElementById("search-input");
      const visitorForm = document.getElementById("visitor-form");
      const toggle = document.getElementById("visitor-toggle");
      const visitorModalEl = document.getElementById("visitor-modal");
      const visitorModal = visitorModalEl ? new bootstrap.Modal(visitorModalEl) : null;
      const resultsModalEl = document.getElementById("search-results-modal");
      const resultsList = document.getElementById("search-results-list");
      const resultsEmpty = document.getElementById("search-results-empty");
      const resultsModal = resultsModalEl ? new bootstrap.Modal(resultsModalEl) : null;
      const printModal = document.getElementById("print-modal");
      const printFrame = document.getElementById("print-frame");
      const printClose = document.getElementById("print-modal-close");
      const printNow = document.getElementById("print-modal-print");
      const keyboard = document.getElementById("kiosk-keyboard");
      const csrfToken = document.querySelector("input[name='csrfmiddlewaretoken']")?.value || "";
      if (toggle && visitorModal) {
        toggle.addEventListener("click", () => {
          if (visitorForm) {
            visitorForm.reset();
          }
          visitorModal.show();
        });
      }

      const showPrintModal = (url) => {
        if (!printModal || !printFrame) return;
        if (resultsModal) {
          resultsModal.hide();
        }
        const iframeUrl = url.includes("?") ? `${url}&iframe=1` : `${url}?iframe=1`;
        printFrame.src = iframeUrl;
        printModal.classList.add("is-visible");
        printModal.setAttribute("aria-hidden", "false");
        if (keyboard) {
          keyboard.classList.add("kiosk-keyboard-hidden");
        }
      };

      const closePrintModal = () => {
        if (!printModal) return;
        printModal.classList.remove("is-visible");
        printModal.setAttribute("aria-hidden", "true");
        if (printFrame) {
          printFrame.src = "about:blank";
        }
        if (keyboard) {
          keyboard.classList.remove("kiosk-keyboard-hidden");
        }
      };

      if (printClose) {
        printClose.addEventListener("click", closePrintModal);
      }

      if (printNow) {
        printNow.addEventListener("click", () => {
          if (printFrame && printFrame.contentWindow) {
            printFrame.contentWindow.print();
          }
        });
      }

      window.addEventListener("message", (event) => {
        if (event.data && event.data.type === "kiosk-print-done") {
          closePrintModal();
          if (resultsModal) {
            resultsModal.hide();
          }
          if (visitorModal) {
            visitorModal.hide();
          }
          input.value = "";
          input.focus();
        }
      });
      if (resultsModalEl) {
        resultsModalEl.addEventListener("shown.bs.modal", () => {
          if (keyboard) {
            keyboard.classList.add("kiosk-keyboard-hidden");
          }
        });
        resultsModalEl.addEventListener("hidden.bs.modal", () => {
          if (keyboard && printModal && !printModal.classList.contains("is-visible")) {
            keyboard.classList.remove("kiosk-keyboard-hidden");
          }
        });
      }
      if (visitorModalEl) {
        visitorModalEl.addEventListener("shown.bs.modal", () => {
          if (keyboard) {
            keyboard.classList.add("kiosk-keyboard-hidden");
          }
        });
        visitorModalEl.addEventListener("hidden.bs.modal", () => {
          if (visitorForm) {
            visitorForm.reset();
          }
          if (keyboard && printModal && !printModal.classList.contains("is-visible")) {
            keyboard.classList.remove("kiosk-keyboard-hidden");
          }
        });
      }

      if (!form || !input) return;
      const createGroupMarkup = (group, groupIndex) => {
        const familyLabel = group.family_name || group.members[0]?.name || "Match";
        const allCheckedIn = group.members.length > 0 && group.members.every((member) => member.checked_in);
        const members = group.members
          .map(
            (member) =>
              `<label class="d-flex align-items-center gap-2 result-member-row ${member.checked_in ? "member-checked-in" : ""}">
                <input class="form-check-input result-person-checkbox" type="checkbox" value="${member.id}" data-group="${groupIndex}" checked />
                <span>${member.name}</span>
                ${
                  member.checked_in
                    ? `<span class="result-member-actions ms-auto d-flex align-items-center gap-2">
                        <span class="badge text-bg-secondary">Already checked in</span>
                        <button class="btn btn-outline-secondary btn-sm reprint-one-btn" type="button" data-person-id="${member.id}" data-primary-id="${group.primary_id}">Reprint nametag</button>
                      </span>`
                    : ""
                }
              </label>`
          )
          .join("");
        return `
          <div class="list-group-item">
            <div class="d-flex flex-column gap-3">
              <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
                <div class="fw-semibold">${familyLabel}</div>
                <div class="d-flex gap-2 flex-wrap">
                  <button class="btn btn-success btn-lg result-action-btn" type="button" data-action="print_selected" data-group="${groupIndex}" data-primary-id="${group.primary_id}">Print Nametags</button>
                  <button class="btn btn-outline-primary btn-lg result-action-btn" type="button" data-action="check_in_selected" data-group="${groupIndex}" data-primary-id="${group.primary_id}" data-family-name="${familyLabel}" data-has-family="${group.family_name ? "1" : "0"}" ${allCheckedIn ? "disabled" : ""}>Check in only</button>
                </div>
              </div>
              <div class="d-flex flex-column gap-2">${members}</div>
            </div>
          </div>
        `;
      };

      const submitAttendance = (formData) => {
        if (!navigator.onLine) {
          alert("Offline: check-in actions require a connection right now.");
          return Promise.resolve(null);
        }
        return fetch(window.location.pathname, {
          method: "POST",
          body: formData,
          headers: {
            "X-Requested-With": "XMLHttpRequest",
            "X-CSRFToken": csrfToken,
          },
        }).then((response) => {
          if (response.status === 423) {
            return { service_closed: true };
          }
          return response.json();
        });
      };

      const performSearch = (value) => {
        if (value.length < 3) {
          if (resultsModal) {
            resultsModal.hide();
          }
          return;
        }
        fetch(`/kiosk/search-groups/?q=${encodeURIComponent(value)}`, {
          headers: { "X-Requested-With": "XMLHttpRequest" },
        })
          .then((response) => {
            if (response.status === 423) {
              return { groups: [], service_closed: true };
            }
            return response.json();
          })
          .then((data) => {
            if (data.service_closed) {
              window.location.href = "/kiosk/logout/?service_closed=1";
              return;
            }
            const groups = data.groups || [];
            if (resultsList) {
              resultsList.innerHTML = groups.map((group, index) => createGroupMarkup(group, index)).join("");
            }
            if (resultsEmpty) {
              resultsEmpty.classList.toggle("d-none", groups.length > 0);
            }
            if (resultsModal) {
              resultsModal.show();
            }
          })
          .catch(() => {
            // Keep kiosk stable even if search endpoint fails.
          });
      };

      const moveCursorToEnd = () => {
        const length = input.value.length;
        try {
          input.setSelectionRange(length, length);
        } catch (err) {
          // Ignore if input type doesn't support selection range.
        }
      };
      moveCursorToEnd();
      form.addEventListener("submit", (event) => {
        event.preventDefault();
        const value = input.value.trim();
        if (value.length < 3) {
          if (resultsModal) {
            resultsModal.hide();
          }
          return;
        }
        performSearch(value);
      });

      input.addEventListener("input", () => {
        const value = input.value.trim();
        if (value.length === 0 && resultsModal) {
          resultsModal.hide();
        }
      });

      if (resultsList) {
        resultsList.addEventListener("click", (event) => {
          const reprintButton = event.target.closest(".reprint-one-btn");
          if (reprintButton) {
            const personId = reprintButton.getAttribute("data-person-id");
            const primaryId = reprintButton.getAttribute("data-primary-id");
            if (!personId) return;
            const formData = new FormData();
            formData.append("csrfmiddlewaretoken", csrfToken);
            formData.append("action", "print_selected");
            formData.append("person_ids", personId);
            if (primaryId) {
              formData.append("primary_person_id", primaryId);
            }
            submitAttendance(formData)
              .then((data) => {
                if (data && data.service_closed) {
                  window.location.href = "/kiosk/logout/?service_closed=1";
                  return;
                }
                if (!data || !data.print_url) return;
                if (iframePrintEnabled) {
                  showPrintModal(data.print_url);
                } else {
                  window.location.href = data.print_url;
                }
              })
              .catch(() => {});
            return;
          }
          const button = event.target.closest(".result-action-btn");
          if (!button) return;
          const groupIndex = button.getAttribute("data-group");
          const primaryId = button.getAttribute("data-primary-id");
          const action = button.getAttribute("data-action");
          const selected = Array.from(
            resultsList.querySelectorAll(`.result-person-checkbox[data-group='${groupIndex}']:checked`)
          ).map((checkbox) => checkbox.value);
          const formData = new FormData();
          formData.append("csrfmiddlewaretoken", csrfToken);
          formData.append("action", action || "print_selected");
          if (primaryId) {
            formData.append("primary_person_id", primaryId);
          }
          selected.forEach((personId) => formData.append("person_ids", personId));
          submitAttendance(formData)
            .then((data) => {
              if (data && data.service_closed) {
                window.location.href = "/kiosk/logout/?service_closed=1";
                return;
              }
              if (!data) return;
              if (data.print_url) {
                if (resultsModal) {
                  resultsModal.hide();
                }
                if (iframePrintEnabled) {
                  showPrintModal(data.print_url);
                } else {
                  window.location.href = data.print_url;
                }
                return;
              }
              if (data.checked_in) {
                if (action === "check_in_selected") {
                  const familyName = button.getAttribute("data-family-name") || "This";
                  const hasFamily = button.getAttribute("data-has-family") === "1";
                  const message = hasFamily ? `${familyName} family checked in!` : `${familyName} checked in!`;
                  alert(message);
                }
                if (resultsModal) {
                  resultsModal.hide();
                }
                input.value = "";
                moveCursorToEnd();
              }
            })
            .catch(() => {});
        });
      }

      if (keyboard) {
        keyboard.addEventListener("click", (event) => {
          const target = event.target;
          if (!(target instanceof HTMLElement)) return;
          const key = target.getAttribute("data-key");
          const action = target.getAttribute("data-action");
          if (key !== null) {
            input.value = `${input.value}${key}`;
            moveCursorToEnd();
            input.dispatchEvent(new Event("input"));
            input.focus();
          } else if (action === "backspace") {
            input.value = input.value.slice(0, -1);
            moveCursorToEnd();
            input.dispatchEvent(new Event("input"));
            input.focus();
          } else if (action === "clear") {
            input.value = "";
            moveCursorToEnd();
            input.dispatchEvent(new Event("input"));
            input.focus();
          }
        });
      }

      const statusEl = document.getElementById("connection-status");
      const statusDot = document.getElementById("status-dot-menu");
      const statusText = document.getElementById("status-text-menu");
      const serviceLine = document.getElementById("service-line-menu");
      const setStatus = (isOnline) => {
        if (statusDot) statusDot.classList.toggle("offline", !isOnline);
        if (statusText) statusText.textContent = isOnline ? "Server online" : "Server offline (queued)";
      };
      const updateStatus = () => {
        if (!navigator.onLine) {
          setStatus(false);
          return;
        }
        fetch("/healthz/", { cache: "no-store" })
          .then((response) => setStatus(response.ok))
          .catch(() => setStatus(false));
      };
      const pollServiceOpen = () => {
        if (!kioskMode || !navigator.onLine) {
          return;
        }
        fetch("/kiosk/status/", { cache: "no-store" })
          .then((response) => response.json())
          .then((data) => {
            if (serviceLine) {
              serviceLine.textContent = data && data.service_open && data.service_label
                ? `Service: ${data.service_label}`
                : "No service open";
            }
            if (data && (data.logout || data.service_open === false)) {
              window.location.href = "/kiosk/logout/?service_closed=1";
            }
          })
          .catch(() => {});
      };
      if (statusEl) {
        updateStatus();
        window.addEventListener("online", updateStatus);
        window.addEventListener("offline", updateStatus);
        setInterval(updateStatus, 15000);
        pollServiceOpen();
        setInterval(pollServiceOpen, 15000);
      }

      const queueKey = "kioskOfflineQueue";
      const enqueue = (payload) => {
        const queue = JSON.parse(localStorage.getItem(queueKey) || "[]");
        queue.push(payload);
        localStorage.setItem(queueKey, JSON.stringify(queue));
      };

      const flushQueue = () => {
        const queue = JSON.parse(localStorage.getItem(queueKey) || "[]");
        if (!queue.length || !navigator.onLine) return;
        const next = queue.shift();
        localStorage.setItem(queueKey, JSON.stringify(queue));
        fetch(next.url, {
          method: "POST",
          body: next.body,
        })
          .then((resp) => {
            if (resp.redirected) {
              window.open(resp.url, "_blank", "noopener,noreferrer");
            }
          })
          .finally(() => {
            setTimeout(flushQueue, 300);
          });
      };

      window.addEventListener("online", () => {
        updateStatus();
        flushQueue();
      });

      if (visitorForm) {
        visitorForm.addEventListener("submit", (event) => {
          const submitter = event.submitter;
          const actionValue = submitter ? submitter.value : "print_single";
          event.preventDefault();
          if (!navigator.onLine) {
            const formData = new FormData(visitorForm);
            formData.set("action", actionValue);
            enqueue({ url: visitorForm.getAttribute("action") || window.location.pathname, body: formData });
            alert("Offline: check-in queued. It will sync when connection returns.");
            updateStatus();
            return;
          }
          const formData = new FormData(visitorForm);
          formData.set("action", actionValue);
          submitAttendance(formData)
            .then((data) => {
              if (!data) return;
              if (data.print_url) {
                if (visitorModal) {
                  visitorModal.hide();
                }
                if (iframePrintEnabled) {
                  showPrintModal(data.print_url);
                } else {
                  window.location.href = data.print_url;
                }
              } else if (data.checked_in) {
                visitorForm.reset();
                if (visitorModal) {
                  visitorModal.hide();
                }
              }
            })
            .catch(() => {
              visitorForm.submit();
            });
        });
      }

      const themeToggle = document.getElementById("theme-toggle");
      const fontToggle = document.getElementById("font-toggle");
      if (themeToggle) {
        const applyTheme = (mode) => {
          if (mode === "dark") {
            document.body.classList.add("dark-mode");
          } else {
            document.body.classList.remove("dark-mode");
          }
        };

        const stored = localStorage.getItem("kioskTheme") || "light";
        applyTheme(stored);

        themeToggle.addEventListener("click", () => {
          const isDark = document.body.classList.toggle("dark-mode");
          localStorage.setItem("kioskTheme", isDark ? "dark" : "light");
        });
      }

      if (fontToggle) {
        const scales = [0.85, 0.95, 1, 1.15, 1.3, 1.45, 1.6];
        const applyScale = (scale) => {
          document.body.style.setProperty("--kiosk-scale", scale.toString());
        };
        const storedScale = parseFloat(localStorage.getItem("kioskFontScale") || "1");
        if (!Number.isNaN(storedScale)) {
          applyScale(storedScale);
        }
        fontToggle.addEventListener("click", () => {
          const current = parseFloat(getComputedStyle(document.body).getPropertyValue("--kiosk-scale")) || 1;
          const idx = scales.indexOf(current);
          const next = scales[(idx + 1) % scales.length];
          applyScale(next);
          localStorage.setItem("kioskFontScale", next.toString());
        });
      }
    })();
  </script>
</body>
</html>
