{% extends "admin/change_form.html" %}

{% block after_related_objects %}
  {{ block.super }}
  {% if original and original.key == "label_font" %}
    <div class="module">
      <h2>Font Preview</h2>
      <p id="font-preview" style="font-size: 20px;">Sample: John Doe</p>
    </div>
    <script>
      (function () {
        const select = document.querySelector("#id_value");
        const preview = document.getElementById("font-preview");
        if (!select || !preview) return;
        const apply = () => {
          preview.style.fontFamily = select.value + ", sans-serif";
        };
        select.addEventListener("change", apply);
        apply();
      })();
    </script>
  {% endif %}
  {% if original and original.key == "kiosk_background_color" or original and original.key == "kiosk_background_color_darkmode" %}
    <div class="module">
      <h2>Color Picker</h2>
      <div style="margin-bottom: 10px;">
        <label for="kiosk-color-picker" style="display: block; margin-bottom: 6px;">Color picker</label>
        <input id="kiosk-color-picker" type="color" value="#ffffff" />
      </div>
    </div>
    <script>
      (function () {
        const input = document.querySelector("#id_value");
        const picker = document.getElementById("kiosk-color-picker");
        if (!input || !picker) return;
        const normalizeHex = (value) => /^#[0-9a-fA-F]{6}$/.test(value) ? value : "#ffffff";
        const apply = () => {
          const hex = normalizeHex(input.value);
          picker.value = hex;
        };
        picker.addEventListener("input", () => {
          input.value = picker.value;
          apply();
        });
        input.addEventListener("input", apply);
        input.addEventListener("change", apply);
        apply();
      })();
    </script>
  {% endif %}
{% endblock %}
